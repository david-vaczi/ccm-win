---
ccm_hc:
  ##############################
  # NO REGISTRY PATH SPECIFIED #
  ##############################
  - name: "Access Credential Manager as a trusted caller"
    ref: "2.2.1"
    action: 'Write-Output "No registry path specified"'

  - name: "Act as part of the operating system"
    ref: "2.2.3"
    action: 'Write-Output "No registry path specified"'

  - name: "Adjust memory quotas for a process"
    ref: "2.2.5"
    action: 'Write-Output "No registry path specified"'

  - name: "Back up files and directories"
    ref: "2.2.8"
    action: 'Write-Output "No registry path specified"'

  - name: "AChange the system time"
    ref: "2.2.9"
    action: 'Write-Output "No registry path specified"'

  - name: "Change the time zone"
    ref: "2.2.10"
    action: 'Write-Output "No registry path specified"'

  - name: "Create a pagefile"
    ref: "2.2.11"
    action: 'Write-Output "No registry path specified"'

  - name: "Create a token object"
    ref: "2.2.12"
    action: 'Write-Output "No registry path specified"'

  - name: "Create global objects"
    ref: "2.2.13"
    action: 'Write-Output "No registry path specified"'

  - name: "Create permanent shared objects"
    ref: "2.2.14"
    action: 'Write-Output "No registry path specified"'

  - name: "Create symbolic links"
    ref: "2.2.15"
    action: 'Write-Output "No registry path specified"'

  - name: "Debug program"
    ref: "2.2.16"
    action: 'Write-Output "No registry path specified"'

  - name: "Enable computer and user accounts to be trusted for delegation"
    ref: "2.2.22"
    action: 'Write-Output "No registry path specified"'

  - name: "Force shutdown from a remote system"
    ref: "2.2.23"
    action: 'Write-Output "No registry path specified"'

  - name: "Generate security audits"
    ref: "2.2.24"
    action: 'Write-Output "No registry path specified"'

  - name: "Impersonate a client after authentication"
    ref: "2.2.25"
    action: 'Write-Output "No registry path specified"'

  - name: "Increase scheduling priority"
    ref: "2.2.26"
    action: 'Write-Output "No registry path specified"'

  - name: "Load and unload device drivers"
    ref: "2.2.27"
    action: 'Write-Output "No registry path specified"'

  - name: "Lock pages in memory"
    ref: "2.2.28"
    action: 'Write-Output "No registry path specified"'

  - name: "Manage auditing and security log"
    ref: "2.2.30"
    action: 'Write-Output "No registry path specified"'

  - name: "Modify an object label"
    ref: "2.2.31"
    action: 'Write-Output "No registry path specified"'

  - name: "Modify firmware environment values"
    ref: "2.2.32"
    action: 'Write-Output "No registry path specified"'

  - name: "Perform volume maintenance tasks"
    ref: "2.2.33"
    action: 'Write-Output "No registry path specified"'

  - name: "Profile single process"
    ref: "2.2.34"
    action: 'Write-Output "No registry path specified"'

  - name: "Profile system performance"
    ref: "2.2.35"
    action: 'Write-Output "No registry path specified"'

  - name: "Replace a process level token"
    ref: "2.2.36"
    action: 'Write-Output "No registry path specified"'

  - name: "Restore files and directories"
    ref: "2.2.37"
    action: 'Write-Output "No registry path specified"'

  - name: "Shuit down the system"
    ref: "2.2.38"
    action: 'Write-Output "No registry path specified"'

  - name: "Take ownership of files or other objects"
    ref: "2.2.40"
    action: 'Write-Output "No registry path specified"'

  ################################
  # REGISTRY PATHS ARE SPECIFIED #
  ################################
  - name: "Accounts: Limit local account use of blank passwords to console logon only"
    ref: "2.3.1.4"
    action: 'if (Get-ItemPropertyValue -Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa -Name LimitBlankPasswordUse) {Write-Output "OK"} else {Write-Output "KO"}'

  - name: "Audit: Shut down system immediately if unable to log security audits"
    ref: "2.3.2.2"
    action: 'if (Get-ItemPropertyValue -Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa -Name CrashOnAuditFail) {Write-Output "KO"} else {Write-Output "OK"}'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER
  - name: "Devices: Allowed to format and eject removable media"
    ref: "2.3.4.1"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name AllocateDASD'

  - name: "Devices: Prevent users from installing printer drivers"
    ref: "2.3.4.2"
    action: 'if (Get-ItemPropertyValue -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Print\Providers\LanMan Print Services\Servers\" -Name AddPrinterDrivers) {Write-Output "OK"} else {Write-Output "KO"}'

  - name: "Domain member: Digitally encrypt or sign secure channel data (always)"
    ref: "2.3.6.1"
    action: 'if (Get-ItemPropertyValue -Path HKLM:\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters -Name RequireSignOrSeal) {Write-Output "OK"} else {Write-Output "KO"}'

  - name: "Domain member: Digitally encrypt secure channel data (when possible)"
    ref: "2.3.6.2"
    action: 'if (Get-ItemPropertyValue -Path HKLM:\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\ -Name SealSecureChannel) {Write-Output "OK"} else {Write-Output "KO"}'

  - name: "Domain member: Digitally sign secure channel data (when possible)"
    ref: "2.3.6.3"
    action: 'if (Get-ItemPropertyValue -Path HKLM:\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\ -Name SignSecureChannel) {Write-Output "OK"} else {Write-Output "KO"}'

  - name: "Domain member: Disable machine account password changes"
    ref: "2.3.6.4"
    action: 'if (Get-ItemPropertyValue -Path HKLM:\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\ -Name DisablePasswordChange) {Write-Output "KO"} else {Write-Output "OK"}'
  
  - name: "Domain member: Maximum machine account password age"
    ref: "2.3.6.5"
    action: 'if (((Get-ItemPropertyValue -Path HKLM:\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\ -Name MaximumPasswordAge) -ne 0) -and ((Get-ItemPropertyValue -Path HKLM:\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\ -Name MaximumPasswordAge) -le 30)) {Write-Output "OK"} else {Write-Output "KO"}'

  - name: "Domain member: Require strong (Windows 2000 or later) session key"
    ref: "2.3.6.6"
    action: 'if (Get-ItemPropertyValue -Path HKLM:\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\ -Name RequireStrongKey) {Write-Output "OK"} else {Write-Output "KO"}'

  - name: "Interactive logon: Prompt user to change password before expiration"
    ref: "2.3.7.7"
    action: 'if (((Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name PasswordExpiryWarning) -ge 5) -and ((Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name PasswordExpiryWarning) -le 14)) {Write-Output "OK"} else {Write-Output "KO"}'

  - name: "Microsoft network client: Digitally sign communications (if server agrees)"
    ref: "2.3.8.2"
    action: 'if (Get-ItemPropertyValue -Path HKLM:\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters\ -Name EnableSecuritySignature) {Write-Output "OK"} else {Write-Output "KO"}'

  - name: "Microsoft network client: Send unencrypted password to third-party SMB servers"
    ref: "2.3.8.3"
    action: 'if (Get-ItemPropertyValue -Path HKLM:\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters\ -Name EnablePlainTextPassword) {Write-Output "KO"} else {Write-Output "OK"}'

  - name: "Microsoft network server: Amount of idle time required before suspending session"
    ref: "2.3.9.1"
    action: 'if (((Get-ItemPropertyValue -Path HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters\ -Name AutoDisconnect) -ne 0) -and ((Get-ItemPropertyValue -Path HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters\ -Name AutoDisconnect) -le 15)) {Write-Output "OK"} else {Write-Output "KO"}'

  - name: "Microsoft network server: Disconnect clients when logon hours expire"
    ref: "2.3.9.4"
    action: 'if (Get-ItemPropertyValue -Path HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters\ -Name EnableForcedLogoff) {Write-Output "OK"} else {Write-Output "KO"}'

  #GAP - NO REGISTRY PATH SPECIFIED
  - name: 'Network access: Allow anonymous SID/Name translation'
    ref: "2.3.10.1"
    action: 'Write-Output "No registry path specified"'

  - name: "Network access: Do not allow anonymous enumeration of SAM accounts"
    ref: "2.3.10.2"
    action: 'if (Get-ItemPropertyValue -Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\ -Name RestrictAnonymousSAM) {Write-Output "OK"} else {Write-Output "KO"}'

  - name: "Network access: Let Everyone permissions apply to anonymous users"
    ref: "2.3.10.5"
    action: 'if (Get-ItemPropertyValue -Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\ -Name EveryoneIncludesAnonymous) {Write-Output "KO"} else {Write-Output "OK"}'

  - name: "Network access: Remotely accessible registry paths"
    ref: "2.3.10.7"
    action: 'if (-not (Compare-Object (Get-ItemPropertyValue -Path HKLM:\SYSTEM\CurrentControlSet\Control\SecurePipeServers\winreg\AllowedExactPaths\ -Name Machine) "System\CurrentControlSet\Control\ProductOptions", "System\CurrentControlSet\Control\Server Applications", "Software\Microsoft\Windows NT\CurrentVersion"))  {Write-Output "OK"} else {Write-Output "KO"}'

  - name: "Network access: Remotely accessible registry paths and sub-paths"
    ref: "2.3.10.8"
    action: 'if (-not (Compare-Object (Get-ItemPropertyValue -Path HKLM:\SYSTEM\CurrentControlSet\Control\SecurePipeServers\winreg\AllowedPaths\ -Name Machine) "System\CurrentControlSet\Control\Print\Printers", "System\CurrentControlSet\Services\Eventlog", "Software\Microsoft\OLAP Server", "Software\Microsoft\Windows NT\CurrentVersion\Print", "Software\Microsoft\Windows NT\CurrentVersion\Windows", "System\CurrentControlSet\Control\ContentIndex", "System\CurrentControlSet\Control\Terminal Server", "System\CurrentControlSet\Control\Terminal Server\UserConfig", "System\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration", "Software\Microsoft\Windows NT\CurrentVersion\Perflib", "System\CurrentControlSet\Services\SysmonLog"))  {Write-Output "OK"} else {Write-Output "KO"}'

  - name: "Network access: Restrict anonymous access to Named Pipes and Shares"
    ref: "2.3.10.9"
    action: 'if (Get-ItemPropertyValue -Path HKLM:\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters -Name RestrictNullSessAccess) {Write-Output "OK"} else {Write-Output "KO"}'

  #Note: The BoI agreed value is "Classic - local users authenticate as themselves". In the registry that is the 0 value.
  - name: "Network access: Sharing and security model for local accounts"
    ref: "2.3.10.11"
    action: 'if (Get-ItemPropertyValue -Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa -Name ForceGuest) {Write-Output "KO"} else {Write-Output "OK"}'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER
  - name: "Network security: Allow LocalSystem NULL session fallback"
    ref: "2.3.11.2"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\MSV1_0" -Name AllowNullSessionFallback'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER
  - name: "Network security: Allow PKU2U authentication requests to this computer to use online identities"
    ref: "2.3.11.3"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\pku2u" -Name AllowOnlineID'

  - name: "Network security: Force logoff when logon hours expire"
    ref: "2.3.11.6"
    action: 'if (Get-ItemPropertyValue -Path HKLM:\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters\ -Name EnableForcedLogOff) {Write-Output "OK"} else {Write-Output "KO"}'

  #GAP DEBUG - THE VALUES ARE NUMERICAL, BUT THE AGREED-UPON VALUES ARE CERTAIN STRINGS - MUST PROVIDE CONVERSION
  - name: "Network security: LDAP client signing requirements"
    ref: "2.3.11.8"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SYSTEM\CurrentControlSet\Services\LsaLDAP\" -Name LDAPClientIntegrity'

  - name: "System objects: Require case insensitivity for non-Windows subsystems"
    ref: "2.3.15.1"
    action: 'if (Get-ItemPropertyValue -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Kernel\" -Name ObCaseInsensitive) {Write-Output "OK"} else {Write-Output "KO"}'

  - name: "System objects: Strengthen default permissions of internal system objects (e.g. Symbolic Links)"
    ref: "2.3.15.2"
    action: 'if (Get-ItemPropertyValue -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\" -Name ProtectionMode) {Write-Output "OK"} else {Write-Output "KO"}'

  - name: "System settings: Optional subsystems"
    ref: "2.3.16.1"
    action: 'if ((Get-ItemPropertyValue -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\SubSystems\" -Name Optional).Count -eq 0) {Write-Output "OK"} else {Write-Output "KO"}'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER
  - name: "Enable Automatic Logon (not recommended)"
    ref: "18.3.1"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name AutoAdminLogon'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER
  - name: "IP source routing protection level (protects against packet spoofing)"
    ref: "18.3.2"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters\" -Name DisableIPSourceRouting'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER
  - name: "IP source routing protection level (protects against packet spoofing)"
    ref: "18.3.3"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\" -Name DisableIPSourceRouting'

  - name: "Allow ICMP redirects to override OSPF generated routes"
    ref: "18.3.4"
    action: 'if (-not (Get-ItemPropertyValue -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\" -Name EnableICMPRedirect)) {Write-Output "OK"} else {Write-Output "KO"}'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER (MUST BE INSTALLED AS ADDITIONAL GROUP POLICY)
  - name: "How often keep-alive packets are sent in milliseconds"
    ref: "18.3.5"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\" -Name KeepAliveTime'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER (MUST BE INSTALLED AS ADDITIONAL GROUP POLICY)
  - name: "Allow the computer to ignore NetBIOS name release requests except from WINS servers"
    ref: "18.3.6"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SYSTEM\CurrentControlSet\Services\NetBT\Parameters\" -Name nonamereleaseondemand'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER (MUST BE INSTALLED AS ADDITIONAL GROUP POLICY)
  - name: "Allow IRDP to detect and configure Default Gateway addresses (could lead to DoS)"
    ref: "18.3.7"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\" -Name PerformRouteDiscovery'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER
  - name: "Enable Safe DLL search mode (recommended)"
    ref: "18.3.8"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\" -Name SafeDllSearchMode'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER
  - name: "The time in seconds before the screen saver grace period expires (0 recommended)"
    ref: "18.3.9"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\" -Name ScreenSaverGracePeriod'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER (MUST BE INSTALLED AS ADDITIONAL GROUP POLICY)
  - name: "How many times unacknowledged data is retransmitted"
    ref: "18.3.10"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters\" -Name tcpmaxdataretransmissions'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER (MUST BE INSTALLED AS ADDITIONAL GROUP POLICY)
  - name: "How many times unacknowledged data is retransmitted"
    ref: "18.3.11"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\" -Name tcpmaxdataretransmissions'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER
  - name: "Percentage threshold for the security event log at which the system will generate a warning"
    ref: "18.3.12"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Eventlog\Security\" -Name WarningLevel'

  - name: "Apply UAC restrictions to local accounts on network logons"
    ref: "18.6.1"
    action: 'if (Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\" -Name LocalAccountTokenFilterPolicy) {Write-Output "OK"} else {Write-Output "KO"}'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER - THE FOLLOWINGS ARE ONE POLICY
  - name: 'Turn on Mapper I/O (LLTDIO) driver'
    ref: "18.4.9.1"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windwos\LLTD\" -Name AllowLLTDIOONDomain'
  - name: 'Turn on Mapper I/O (LLTDIO) driver'
    ref: "18.4.9.1"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windwos\LLTD\" -Name AllowLLTDIOOnPublicNet'
  - name: 'Turn on Mapper I/O (LLTDIO) driver'
    ref: "18.4.9.1"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windwos\LLTD\" -Name EnableLLTDIO'
  - name: 'Turn on Mapper I/O (LLTDIO) driver'
    ref: "18.4.9.1"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windwos\LLTD\" -Name ProhibitLLTDIOOnPrivateNet'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER - THE FOLLOWINGS ARE ONE POLICY
  - name: 'Turn on Responder (RSPNDR) driver'
    ref: "18.4.9.2"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windwos\LLTD\" -Name AllowRspndrOnDomain'
  - name: 'Turn on Responder (RSPNDR) driver'
    ref: "18.4.9.2"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windwos\LLTD\" -Name AllowRspndrOnPublicNet'
  - name: 'Turn on Responder (RSPNDR) driver'
    ref: "18.4.9.2"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windwos\LLTD\" -Name EnableRspndr'
  - name: 'Turn on Responder (RSPNDR) driver'
    ref: "18.4.9.2"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windwos\LLTD\" -Name ProhibitRspndrOnPrivateNet'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER
  - name: "Turn off Microsoft Peer-to-Peer Networking Services"
    ref: "18.4.10.2"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Peernet\" -Name Disabled'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER - THE FOLLOWINGS ARE ONE POLICY
  - name: 'Configuration of wireless settings using Windows Connect Now'
    ref: "18.4.20.1"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windwos\WCN\Registrars\" -Name EnableRegistrars'
  - name: 'Configuration of wireless settings using Windows Connect Now'
    ref: "18.4.20.1"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windwos\WCN\Registrars\" -Name DisableUPnPRegistrar'
  - name: 'Configuration of wireless settings using Windows Connect Now'
    ref: "18.4.20.1"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windwos\WCN\Registrars\" -Name DisableInBand802DOT11Registrar'
  - name: 'Configuration of wireless settings using Windows Connect Now'
    ref: "18.4.20.1"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windwos\WCN\Registrars\" -Name DisableFlashConfigRegistrar'
  - name: 'Configuration of wireless settings using Windows Connect Now'
    ref: "18.4.20.1"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windwos\WCN\Registrars\" -Name DisableWPDRegistrar'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER
  - name: "Prohibit access of the Windows Connect Now wizards"
    ref: "18.4.20.2"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\WCN\UI\" -Name DisableWcnUi'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER
  - name: "Prohibit connection to non-domain networks when connected to domain authenticated network"
    ref: "18.4.21.2"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WcmSvc\GroupPolicy\" -Name BlockNonDomain'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER
  - name: "NO NAME WAS SPECIFIED FOR THE SETTING"
    ref: "18.4.19.2.1"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters\" -Name DisabledComponents'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER
  - name: 'Pass the Hash Mitigations\WDigest Authentication (disabling may require KB2871997)'
    ref: "18.6.2"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest\" -Name UseLogonCredential'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER
  - name: 'Prevent enabling lock screen camera'
    ref: "18.1.1.1"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\Personalization\" -Name NoLockScreenCamera'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER
  - name: 'Prevent enabling lock screen slide show'
    ref: "18.1.1.2"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\Personalization\" -Name NoLockScreenSlideshow'

  #GAP DEBUG - REGISTRY PATH NOT FOUND FOR TEST SERVER
  - name: 'Firewall state'
    ref: "9.1.1"
    action: 'Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\" -Name EnableFirewall'
  
  


